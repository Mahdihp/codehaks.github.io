<!DOCTYPE html>
<html lang="en-us" class="wf-firasans-n4-active wf-active">
	<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Enable responsiveness on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    <meta name="generator" content="Hugo 0.40.3" />
    
    <title>Injecting LiteDb as a service in ASP.NET Core &middot; Codehaks</title>
    <meta content="Injecting LiteDb as a service in ASP.NET Core - Codehaks" property="og:title">
    <meta content=" - " property="og:description">
    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i|Roboto+Mono:300,300i,400,400i" rel="stylesheet">
    <link rel="stylesheet" href="https://codehaks.github.io/css/print.css" media="print">
    <link rel="stylesheet" href="https://codehaks.github.io/css/poole.css">
    <link rel="stylesheet" href="https://codehaks.github.io/css/hyde.css">
    <!-- Font-Awesome -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous"></script>
    
    <!-- Customised CSS -->
    <link rel="stylesheet" href="https://codehaks.github.io/css/custom.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

	</head>
    <body>
        <div class="sidebar">
	<div class="container text-center sidebar-sticky">
		<div class="sidebar-about text-center">
	
			<a href="https://codehaks.github.io/"><h1 class="brand">Codehaks</h1></a>
			
			<p class="lead">
				 Daily adventures of a web developer 
			</p>
		</div>
		
<div>
	<ul class="sidebar-nav">
		
		
		</li>
	</ul>
</div>

        <p>
		<section class="row text-center">
	
	
	
	
	
	
	
	
	
	
</section>

        </p>
		<p class="copyright">&copy; 2018 Hakim Ghods.
        <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
        </p>
	</div>
	<div>
	</div>
</div>

        <div class="content container">
            <div class="post">
  <h1>Injecting LiteDb as a service in ASP.NET Core</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
            
       
        <i class="fas fa-calendar-alt"></i> Oct 01, 2018
      
      
      
      
      <br/>
      <i class="fas fa-clock"></i> 2 min read 
      </span>  
  </div>    
  
  

<h1 id="intoduction">Intoduction</h1>

<p>LiteDB is a simple, fast and lightweight embedded .NET document database. LiteDB was inspired by the MongoDB database and its API is very similar to MongoDB&rsquo;s official .NET API.</p>

<h1 id="situation">Situation</h1>

<p>I have been using LiteDb for some of my smaller projects and I&rsquo;ve got to tell you that so far it has beed satisfying. But my problem was injecting LiteDb as a service inside ASP.NET Core applications. Usually in ASP.NET Core all buit in services are added like this :</p>

<pre><code class="language-csharp"> public void ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
        }
</code></pre>

<p>Of course it&rsquo;s possible to inject your services using &ldquo;Action&rdquo; syntax like this :</p>

<pre><code class="language-csharp"> public void ConfigureServices(IServiceCollection services)
        {
            ServicesConfig.Register(services);
        }

         public static void Register(IServiceCollection services)
        {
           
            services.AddTransient&lt;IProductService, ProductService&gt;();
            services.AddTransient&lt;IOrderService, OrderService&gt;();
        }
</code></pre>

<p>But thats not what I want. I want to have a neat looking startup. And I have seen a couple of popular frameworks like AutoMapper already using this :</p>

<pre><code class="language-csharp">     services.AddAutoMapper();
</code></pre>

<p>Implemention
I have always wanted to have something similar with my other services.So I tried to implement it for LiteDb.</p>

<h3 id="first-step">First Step</h3>

<p>first I used a different class to to keep all necessary configurations separately. For LiteDb we only need a path to create database file.
<script src="https://gist.github.com/codehaks/9ca799a0734f8cc775f0d585febdcca3.js"></script></p>

<h3 id="second-step">Second Step</h3>

<p>Next I added an other class for the actual LiteDb service.</p>

<script src="https://gist.github.com/codehaks/12b528749e07d53a7451f14d9162dada.js"></script>

<h3 id="finally">Finally</h3>

<p>The last step would be to add an extension to <em>IServiceCollection</em> interface.</p>

<script src="https://gist.github.com/codehaks/7e19f5e4a545c4f987d244640868c334.js"></script>

<p>Then all we need to do is add &ldquo;usings&rdquo; and call *AddLiteDb&rdquo; in ConfigureServices method at startup.</p>

<pre><code class="language-csharp">public void ConfigureServices(IServiceCollection services)
        {
            services.AddMvc();
            services.AddLiteDb(@&quot;bug.db&quot;);
        }
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>Extensions in C# usally help with technical needs but in many cases we use them to add cleaner look in code. The best was to create an extension is to move backwards and start from the end.</p>

<p>You can download the source code <a href="https://github.com/codehaks/BugPages">https://github.com/codehaks/BugPages</a> here.</p>

</div>
            <div class="footer">
                


        <h2>Comments</h2>
        <div id="disqus_thread"></div>
<script type="text/javascript">
      (function () {
            
            
            
            if (location.hostname === "localhost" || 
            	location.hostname === "127.0.0.1" || 
            	location.hostname === "") {
                return;
			}
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            var disqus_shortname = 'codehaks';
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(
                  dsq);
      })();
</script>

<noscript>
	Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      

            </div>
        </div>
        
        
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-105746611-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
        
    </body>
</html>
